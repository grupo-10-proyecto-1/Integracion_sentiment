<app-header></app-header>
<app-mock-carousel></app-mock-carousel>
<div
  class="relative min-h-screen bg-indigo-950 dark:bg-slate-950 transition-colors duration-300"
>
  <!-- Drawer Toggle -->
  <button
    (click)="showHistory = !showHistory"
    class="fixed right-4 top-24 z-50 p-3 bg-indigo-600 hover:bg-indigo-500 shadow-lg rounded-full text-white transition-all hover:scale-110"
    title="Ver Historial"
  >
    <span>üï∞Ô∏è</span>
  </button>

  <!-- History Drawer -->
  <div
    class="fixed inset-y-0 right-0 w-80 bg-slate-950/95 backdrop-blur-xl border-l border-slate-800 shadow-2xl transform transition-transform duration-300 z-50 p-4 pt-20"
    [class.translate-x-0]="showHistory"
    [class.translate-x-full]="!showHistory"
  >
    <button
      (click)="showHistory = false"
      class="absolute top-4 right-4 text-slate-400 hover:text-white"
    >
      ‚úï
    </button>

    <app-sentiment-history
      [history]="history"
      (selectItem)="selectHistoryItem($event); showHistory = false"
    >
    </app-sentiment-history>
  </div>

  <app-sentiment-form
    [apiOnline]="apiOnline"
    [checkingApi]="checkingApi"
    (analyzeText)="analyze($event)"
    (batchComplete)="loadMetrics()"
  >
  </app-sentiment-form>

  <app-sentiment-result
    id="sentiment-result"
    *ngIf="result"
    [text]="text"
    [result]="result"
  >
  </app-sentiment-result>

  <app-sentiment-metrics
    *ngIf="metrics; else metricsSkeleton"
    [metrics]="metrics"
  >
  </app-sentiment-metrics>

  <ng-template #metricsSkeleton>
    <div class="max-w-7xl mx-auto px-4 py-8 animate-pulse">
      <div class="relative">
        <!-- Header Skeleton -->
        <div class="flex items-center gap-4 mb-8">
          <div
            class="w-16 h-16 rounded-full bg-indigo-500/10 dark:bg-slate-700/50"
          ></div>
          <div>
            <div class="h-8 w-64 bg-slate-700/50 rounded mb-2"></div>
            <div class="h-4 w-40 bg-slate-700/30 rounded"></div>
          </div>
        </div>

        <!-- Cards Grid -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Card 1 -->
          <div
            class="bg-white/50 dark:bg-slate-900/50 rounded-[2rem] p-6 h-48 border border-indigo-200/50 dark:border-white/5 flex flex-col justify-between"
          >
            <div class="h-6 w-32 bg-slate-700/30 rounded"></div>
            <div class="space-y-3">
              <div class="h-10 w-24 bg-slate-700/50 rounded"></div>
              <div class="h-2 w-full bg-slate-700/20 rounded-full"></div>
            </div>
          </div>
          <!-- Card 2 -->
          <div
            class="bg-white/50 dark:bg-slate-900/50 rounded-[2rem] p-6 h-48 border border-indigo-200/50 dark:border-white/5 flex flex-col justify-between"
          >
            <div class="h-6 w-32 bg-slate-700/30 rounded"></div>
            <div class="flex gap-2 items-end h-24">
              <div class="h-[80%] w-8 bg-slate-700/30 rounded-t"></div>
              <div class="h-[40%] w-8 bg-slate-700/30 rounded-t"></div>
              <div class="h-[60%] w-8 bg-slate-700/30 rounded-t"></div>
            </div>
          </div>
          <!-- Card 3 -->
          <div
            class="bg-white/50 dark:bg-slate-900/50 rounded-[2rem] p-6 h-48 border border-indigo-200/50 dark:border-white/5 flex flex-col justify-between"
          >
            <div class="h-6 w-32 bg-slate-700/30 rounded"></div>
            <div class="h-12 w-32 bg-slate-700/50 rounded"></div>
          </div>
        </div>
      </div>
    </div>
  </ng-template>

  <app-footer></app-footer>
</div>
